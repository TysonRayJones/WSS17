(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48304,       1213]
NotebookOptionsPosition[     45621,       1140]
NotebookOutlinePosition[     45994,       1156]
CellTagsIndexPosition[     45951,       1153]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Numerical Diagonalisation of an arbitrary* Hamiltonian", "Title",
 CellChangeTimes->{{3.7074311443022237`*^9, 3.707431150958149*^9}, {
  3.7075759231896653`*^9, 
  3.7075759326341047`*^9}},ExpressionUUID->"82d16c13-a4eb-4dff-88b1-\
256f342d7961"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"confirm", " ", "output", " ", "is", " ", "correct", " ", 
    RowBox[{"eigenstate", "?", " ", "Maybe"}], " ", "solve", " ", 
    RowBox[{"T", ".", "I"}], " ", "schrod", " ", 
    RowBox[{"(", 
     RowBox[{"with", " ", "energy", " ", "of", " ", "each"}], ")"}]}], ",", 
   " ", 
   RowBox[{
   "access", " ", "interpoators", " ", "at", " ", "grid", " ", "points", " ", 
    "and", " ", "compare", " ", "list"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7079584272818594`*^9, 
  3.7079584656607695`*^9}},ExpressionUUID->"8d204cd5-d7c9-431b-b385-\
1ca7530127c3"],

Cell[CellGroupData[{

Cell["Initialisation", "Section",
 CellChangeTimes->{{3.7074728833753977`*^9, 
  3.7074728851626635`*^9}},ExpressionUUID->"84fa818c-6a8a-4d1c-be9c-\
f9313f98a286"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{"PacletDirectoryAdd", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
 RowBox[{"<<", " ", "EigenFunctions`"}], "\n", 
 RowBox[{"<<", " ", "PlotFunctions`"}]}], "Code",
 CellChangeTimes->{
  3.707401573738562*^9, {3.707958309404728*^9, 
   3.7079583139354763`*^9}},ExpressionUUID->"7d33919b-3482-4426-ba8e-\
615f4ccc7d13"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing Accuracy", "Section",
 CellChangeTimes->{{3.7077453510935125`*^9, 
  3.707745352929616*^9}},ExpressionUUID->"8aa0a0d4-6a0c-4926-8145-\
f356b8db5238"],

Cell["\<\
Remember that the smaller the energy eigenvalue, the slower the eigenfunction\
\[CloseCurlyQuote]s phase will evolve in time!\
\>", "Text",
 CellChangeTimes->{{3.70775154196348*^9, 
  3.707751569300905*^9}},ExpressionUUID->"39c285aa-e9d8-4f9d-9eec-\
943d61ef708a"],

Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"solveEvolution", "::", "usage"}], " ", "=", " ", 
    "\"\<returns an interpolator of the spacetime evolution of a continuous \
wavefunction\>\""}], ";", "\n", "\n", 
   RowBox[{
    RowBox[{"solveEvolution", "[", 
     RowBox[{"psi_", ",", " ", "potential_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"xL_", ",", " ", "xR_"}], "}"}], ",", " ", 
      RowBox[{"duration_:", "1"}]}], "]"}], " ", ":=", "\n", "\t", 
    RowBox[{"NDSolveValue", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"\[ImaginaryI]", 
          StyleBox[" ", "Code"], 
          StyleBox[
           RowBox[{
            SuperscriptBox["\[Psi]", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", " ", "t"}], "]"}], "Code"]}], 
         StyleBox[" ", "Code"], 
         StyleBox["\[Equal]", "Code"], 
         StyleBox["  ", "Code"], 
         StyleBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              SuperscriptBox["\[Psi]", 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"2", ",", "0"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x", ",", " ", "t"}], "]"}]}], " ", "/", " ", "2"}], 
           " ", "+", " ", 
           RowBox[{
            RowBox[{"\[Psi]", "[", 
             RowBox[{"x", ",", " ", "t"}], "]"}], " ", 
            RowBox[{"potential", "[", "x", "]"}]}]}], "Code"]}], 
        StyleBox[",", "Code"], 
        StyleBox["\n", "Code"], 
        StyleBox["\t\t\t", "Code"], 
        RowBox[{
         StyleBox[
          RowBox[{"\[Psi]", "[", 
           RowBox[{"x", ",", " ", "0"}], "]"}], "Code"], 
         StyleBox[" ", "Code"], 
         StyleBox["\[Equal]", "Code"], " ", 
         RowBox[{"psi", "[", "x", "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"xL", ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", "0"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"xR", ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", "0"}]}],
        "\n", "\t\t", "}"}], ",", "\n", "\t\t", "\[Psi]", ",", " ", "\n", 
      "\t\t", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "xL", ",", " ", "xR"}], "}"}], ",", "\n", 
      "\t\t", 
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "0", ",", " ", "duration"}], "}"}]}], "\n", 
     "\t", "]"}]}], ";", "\n", "\n", 
   RowBox[{
    RowBox[{"solveDiscreteEvolution", "::", "usage"}], " ", "=", " ", 
    "\"\<returns an interpolator of the spacetime evolution a discrete \
wavefunction\>\""}], ";", "\n", "\t\t\t\t", "\n", 
   RowBox[{
    RowBox[{"solveDiscreteEvolution", "[", 
     RowBox[{"\[Phi]list_", ",", " ", "Vlist_", ",", " ", "grid_", ",", " ", 
      RowBox[{"duration_:", "1"}]}], "]"}], " ", ":=", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "xL", ",", " ", "xR", ",", " ", "psi", ",", " ", "\[Phi]clone", ",", 
          " ", "potential", ",", " ", "evol"}], "}"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"xL", " ", "=", " ", 
          RowBox[{"grid", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"xR", " ", "=", " ", 
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\n", "\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"enforce", " ", "boundary", " ", "conditions"}], " ", 
          "*)"}], "\n", "\t\t", 
         RowBox[{"\[Phi]clone", " ", "=", " ", "\[Phi]list"}], ";", "\n", 
         "\t\t", "\n", "\t\t", 
         RowBox[{"(*", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]clone", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"\[Phi]clone", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", "0"}]}], 
           ";"}], "\n", "\t\t", "*)"}], "\n", "\t", "\n", "\t\t\t", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "build", " ", "continuous", " ", "functions", " ", "for", " ", 
           "evolution"}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"psi", " ", "=", " ", 
          RowBox[{"ListInterpolation", "[", 
           RowBox[{"\[Phi]clone", ",", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"xL", ",", " ", "xR"}], "}"}], "}"}], ",", " ", 
            RowBox[{"Method", " ", "\[Rule]", " ", "\"\<Spline\>\""}]}], 
           "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"potential", " ", "=", " ", 
          RowBox[{"ListInterpolation", "[", 
           RowBox[{"Vlist", ",", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"xL", ",", " ", "xR"}], "}"}], "}"}], ",", " ", 
            RowBox[{"Method", " ", "\[Rule]", " ", "\"\<Spline\>\""}]}], 
           "]"}]}], ";", " ", "\n", "\t\t", 
         RowBox[{"solveEvolution", "[", 
          RowBox[{"psi", ",", " ", "potential", ",", " ", 
           RowBox[{"{", 
            RowBox[{"xL", ",", " ", "xR"}], "}"}], ",", " ", "duration"}], 
          "]"}]}]}], "\n", "\t", "]"}], "\n", "\t", "\n", 
      RowBox[{"animateDiscreteEvolution", "::", "usage"}]}], " ", "=", " ", 
     "\"\<returns an animation of the spacetime evolution of a discrete \
wavefunction\>\""}]}], ";", "\n", "\t\t", "\n", 
   RowBox[{
    RowBox[{"animateDiscreteEvolution", "[", 
     RowBox[{"\[Phi]list_", ",", " ", "Vlist_", ",", " ", "grid_", ",", " ", 
      RowBox[{"duration_:", "1"}]}], "]"}], " ", ":=", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"DynamicModule", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"{", "evol", "}"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"evol", " ", "=", " ", 
          RowBox[{"solveDiscreteEvolution", "[", 
           RowBox[{"\[Phi]list", ",", " ", "Vlist", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
            "duration"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"Animate", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"plotContinuous\[Psi]", "[", 
            RowBox[{
             RowBox[{"evol", "[", 
              RowBox[{"x", ",", " ", "t"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", 
               RowBox[{"grid", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
             "False"}], "]"}], ",", "\n", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", "duration"}], "}"}]}], "\n",
           "\t\t", "]"}]}]}], "\n", "\t", "]"}], "\n", "\t", "\n", 
      RowBox[{"animateEigensystemEvolutionNEW", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eigvals_", ",", " ", "eigfuncs_"}], "}"}], ",", " ", 
        "Vlist_", ",", " ", "grid_", ",", " ", 
        RowBox[{"duration_:", "1"}]}], "]"}]}], " ", ":=", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"DynamicModule", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{"{", "solutions", "}"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"solutions", "[", "n_", "]"}], " ", ":=", " ", "\n", 
           "\t\t\t", 
           RowBox[{
            RowBox[{"solutions", "[", "n", "]"}], " ", "=", " ", 
            RowBox[{"solveDiscreteEvolution", "[", 
             RowBox[{
              RowBox[{"eigfuncs", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", " ", "Vlist", ",", " ", 
              "grid", ",", " ", "duration"}], "]"}]}]}], ";", "\n", "\t\t", 
          RowBox[{"Manipulate", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"plotContinuous\[Psi]", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"solutions", "[", "n", "]"}], "[", 
               RowBox[{"x", ",", " ", "t"}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", " ", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
              "False"}], "]"}], ",", "\n", "\t\t\t", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "duration"}], "}"}], ",", 
            "\n", "\t\t\t", 
            RowBox[{"{", 
             RowBox[{"n", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "[", "eigfuncs", "]"}], ",", " ", "1"}], 
             "}"}], ",", "\n", "\t\t\t", 
            RowBox[{"ContinuousAction", " ", "\[Rule]", " ", "False"}]}], 
           "\n", "\t\t", "]"}]}]}], "\n", "\t", "]"}], "\n", "\t", "\n", 
       RowBox[{"animateEigensystemEvolution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"eigvals_", ",", " ", "eigfuncs_"}], "}"}], ",", " ", 
         "Vlist_", ",", " ", "grid_", ",", " ", 
         RowBox[{"duration_:", "1"}]}], "]"}]}], " ", ":=", "\n", "\t", 
      RowBox[{"DynamicModule", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"{", "animFunc", "}"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"animFunc", "[", "n_", "]"}], " ", ":=", " ", "\n", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"animFunc", "[", "n", "]"}], " ", "=", " ", 
           RowBox[{"animateDiscreteEvolution", "[", 
            RowBox[{
             RowBox[{"eigfuncs", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", " ", "Vlist", ",", " ", 
             "grid", ",", " ", "duration"}], "]"}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Manipulate", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"animFunc", "[", "n", "]"}], ",", "\n", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"n", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "eigfuncs", "]"}], ",", " ", "1"}], "}"}],
            ",", "\n", "\t\t\t", 
           RowBox[{"ContinuousAction", " ", "\[Rule]", " ", "False"}]}], "\n",
           "\t\t", "]"}]}]}], "\n", "\t", "]"}]}]}]}]}], "\n", "*)"}]], "Code",
 CellChangeTimes->{{3.707745597089021*^9, 3.7077456648171434`*^9}, {
   3.7077457022977667`*^9, 3.707745786369939*^9}, {3.7077480521436253`*^9, 
   3.7077482004292736`*^9}, {3.7077482464231052`*^9, 3.707748302461116*^9}, {
   3.707748335102894*^9, 3.7077483637519894`*^9}, {3.7077484093459797`*^9, 
   3.7077486157175207`*^9}, {3.707748672946224*^9, 3.7077486924971266`*^9}, {
   3.7077487307384534`*^9, 3.707748829554199*^9}, {3.707749196528694*^9, 
   3.7077492036321187`*^9}, {3.7077492408972187`*^9, 
   3.7077493403264093`*^9}, {3.707749376824896*^9, 3.7077494013602686`*^9}, 
   3.7077505204412146`*^9, {3.7077507887396965`*^9, 3.7077507935476427`*^9}, {
   3.7077511485837283`*^9, 3.7077511567355165`*^9}, {3.7077513036154957`*^9, 
   3.7077513048729086`*^9}, {3.7077513685451393`*^9, 3.707751383096575*^9}, {
   3.707751583383531*^9, 3.7077516621962776`*^9}, {3.7077516970787315`*^9, 
   3.707751735302374*^9}, {3.7077534494719133`*^9, 3.7077534546784945`*^9}, 
   3.707753667483102*^9, {3.7077537605830493`*^9, 3.7077537625442753`*^9}, {
   3.7077538224431305`*^9, 3.707753869863181*^9}, {3.707753907233263*^9, 
   3.70775392404807*^9}, {3.7077539733450856`*^9, 3.7077540202829123`*^9}, {
   3.707754071860353*^9, 3.7077541033419657`*^9}, {3.7077541501778927`*^9, 
   3.7077541618625307`*^9}, {3.707754194443331*^9, 3.7077542903761215`*^9}, {
   3.7077544583294888`*^9, 3.70775447031217*^9}, {3.7077545480722375`*^9, 
   3.7077545503691626`*^9}, {3.7077549237263937`*^9, 
   3.7077549273726087`*^9}, {3.7077549827041454`*^9, 
   3.7077549964828157`*^9}, {3.7077554847335367`*^9, 
   3.7077554893508797`*^9}, {3.707755530202724*^9, 3.7077555345350657`*^9}, {
   3.707755739063572*^9, 3.7077557413334775`*^9}, {3.7077563498164682`*^9, 
   3.7077564224227467`*^9}, {3.707756490844739*^9, 3.7077565096571674`*^9}, {
   3.707756602496789*^9, 3.707756613203624*^9}, {3.70775669574267*^9, 
   3.707756731837604*^9}, 3.707756824244568*^9, {3.7077575142198725`*^9, 
   3.7077575249379606`*^9}, {3.707757723919218*^9, 3.70775772502247*^9}, {
   3.7077579823342385`*^9, 3.7077580383795795`*^9}, {3.7077581892442017`*^9, 
   3.7077581921209154`*^9}, {3.7077705160703154`*^9, 
   3.7077705174536047`*^9}, {3.707771271776663*^9, 3.707771423568451*^9}, {
   3.7077721531064043`*^9, 3.7077721535286818`*^9}, {3.7077725934153996`*^9, 
   3.7077726039763355`*^9}, {3.7077727108142967`*^9, 
   3.7077727176304584`*^9}, {3.7077727665276833`*^9, 3.707772809781972*^9}, {
   3.7077732334611135`*^9, 3.707773244810606*^9}, {3.7077738308465185`*^9, 
   3.7077738312784705`*^9}, {3.707774637666922*^9, 3.7077746654795694`*^9}, {
   3.707971796633279*^9, 
   3.707971804135705*^9}},ExpressionUUID->"b8a9d512-be86-4be1-b81d-\
5867eff2bd7b"],

Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"animateSpectrum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x_", ",", " ", "xL_", ",", " ", "xR_", ",", " ", "\[CapitalDelta]x_"}],
       "}"}], ",", " ", "V_", ",", " ", 
     RowBox[{"numModes_:", "4"}], ",", " ", 
     RowBox[{"duration_:", "1"}]}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"DynamicModule", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "grid", ",", " ", "potential", ",", " ", "eigfuncs", ",", " ", 
       "eigvals"}], "}"}], ",", "\n", "\t\t\t", "\n", "\t\t", 
     RowBox[{
      RowBox[{"grid", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"xL", ",", " ", "xR", ",", " ", "\[CapitalDelta]x"}], "]"}]}],
       ";", "\n", "\t\t", 
      RowBox[{"potential", " ", "=", " ", 
       RowBox[{"If", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"V", " ", "===", " ", "0"}], ",", "\n", "\t\t\t", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"Length", "[", "grid", "]"}]}], "]"}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"V", " ", "/.", " ", 
             RowBox[{"x", " ", "\[Rule]", " ", "#1"}]}], " ", "&"}], ")"}], 
          " ", "@", " ", "grid"}]}], "\n", "\t\t", "]"}]}], ";", "\n", "\t\t",
       "\n", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "add", " ", "very", " ", "high", " ", "potential", " ", "to", " ", 
          "end"}], "-", 
         RowBox[{"points", " ", "to", " ", "improve", " ", "stability"}]}], 
        ";", " ", 
        RowBox[{"finite", " ", 
         RowBox[{"differences", " ", ":", 
          RowBox[{"'", "c"}]}]}]}], "  ", "*)"}], "\n", "\t\t", 
      RowBox[{
       RowBox[{"potential", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"potential", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", 
        SuperscriptBox["10", "4"]}]}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eigvals", ",", " ", "eigfuncs"}], "}"}], " ", "=", " ", 
       RowBox[{"getEigenmodes", "[", 
        RowBox[{"potential", ",", " ", "grid", ",", " ", "numModes"}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"animateEigensystemEvolutionNEW", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eigvals", ",", " ", "eigfuncs"}], "}"}], ",", " ", 
        "potential", ",", " ", "grid", ",", " ", "duration"}], "]"}]}]}], 
    "\n", "]"}]}], "\n", "*)"}]], "Code",
 CellChangeTimes->{
  3.7077558632326317`*^9, {3.7077560768559923`*^9, 3.7077561437512097`*^9}, {
   3.70775625911913*^9, 3.70775626338828*^9}, {3.7077566501064672`*^9, 
   3.707756662365301*^9}, {3.7077567968838425`*^9, 3.7077567991818404`*^9}, {
   3.7077568321869106`*^9, 3.7077568325423*^9}, {3.7077581702777967`*^9, 
   3.707758171092746*^9}, 3.707770822724289*^9, {3.7077708978388104`*^9, 
   3.7077709011336794`*^9}, {3.7077714382543263`*^9, 3.707771438439131*^9}, {
   3.70797180591973*^9, 
   3.707971809495449*^9}},ExpressionUUID->"969b1a4d-a0e9-4dbe-9e98-\
a5830560f3e7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing new Simulations Paclet", "Title",
 CellChangeTimes->{{3.708140302654069*^9, 
  3.708140309624049*^9}},ExpressionUUID->"b77b4dee-994d-4818-9539-\
89d8f9988110"],

Cell[BoxData[
 RowBox[{
  RowBox[{"schrodEqu", "[", 
   RowBox[{"V_", ",", " ", "r__", ",", " ", "t_"}], "]"}], " ", ":=", "\n", 
  StyleBox[
   RowBox[{"\t", 
    StyleBox[" ", "Code"]}]], 
  RowBox[{
   RowBox[{
    StyleBox["\[ImaginaryI]", "Code"], 
    StyleBox[" ", "Code"], 
    RowBox[{"D", 
     StyleBox["[", "Code"], 
     StyleBox[
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"r", ",", " ", "t"}], "]"}], ",", " ", "t"}], "Code"], 
     StyleBox["]", "Code"]}]}], 
   StyleBox[" ", "Code"], 
   StyleBox["\[Equal]", "Code"], 
   StyleBox["  ", "Code"], 
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["-", "Code"], 
      StyleBox[" ", "Code"], 
      RowBox[{
       StyleBox["Laplacian", "Code"], 
       StyleBox["[", "Code"], 
       RowBox[{
        RowBox[{"\[Psi]", 
         StyleBox["[", "Code"], 
         StyleBox[
          RowBox[{"r", ",", " ", "t"}], "Code"], 
         StyleBox["]", "Code"]}], 
        StyleBox[",", "Code"], 
        StyleBox[" ", "Code"], 
        StyleBox[
         RowBox[{"{", "r", "}"}], "Code"]}], 
       StyleBox["]", "Code"]}]}], 
     StyleBox[" ", "Code"], 
     StyleBox["/", "Code"], 
     StyleBox[" ", "Code"], 
     StyleBox["2", "Code"]}], 
    StyleBox[" ", "Code"], 
    StyleBox["+", "Code"], 
    StyleBox[" ", "Code"], 
    StyleBox[
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"r", ",", " ", "t"}], "]"}], " ", 
      RowBox[{"V", "[", "r", "]"}]}], "Code"]}]}]}]], "Input",
 CellChangeTimes->{{3.70814165831456*^9, 
  3.7081416588153934`*^9}},ExpressionUUID->"8c52806e-1500-43c6-aa21-\
1d199c8e51e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"schrodEqu", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      SuperscriptBox["#", "2"]}], "&"}], ")"}], ",", " ", "x", ",", " ", "y", 
   ",", " ", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.708140323814259*^9, 3.7081403647776566`*^9}, {
  3.7081433344430575`*^9, 
  3.708143334696188*^9}},ExpressionUUID->"5eef8d93-58c3-450f-88b0-\
237c6372469d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{
    SuperscriptBox["\[Psi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["x", "2"], " ", 
    RowBox[{"\[Psi]", "[", 
     RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        SuperscriptBox["\[Psi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[Psi]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.7081403417164474`*^9, 3.708140365545968*^9}, 
   3.7081412782193403`*^9, 3.708141662345926*^9, 
   3.7081433350442705`*^9},ExpressionUUID->"af4299bd-acb6-47b8-b163-\
773ef5db0721"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NDSolveValue", "[", "\n", "\t\t", 
  RowBox[{
   RowBox[{"{", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"schrodEqu", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         SuperscriptBox["#", "2"]}], "&"}], ",", " ", "x", ",", " ", "t"}], 
      "]"}], 
     StyleBox[",", "Code"], 
     StyleBox["\n", "Code"], 
     StyleBox["\t\t\t", "Code"], 
     RowBox[{
      StyleBox[
       RowBox[{"\[Psi]", "[", 
        RowBox[{"x", ",", " ", "0"}], "]"}], "Code"], 
      StyleBox[" ", "Code"], 
      StyleBox["\[Equal]", "Code"], " ", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       FractionBox["1", 
        SuperscriptBox["\[Pi]", 
         RowBox[{"1", "/", "4"}]]], 
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{"-", 
          SuperscriptBox["x", "2"]}], "2"], "]"}], " ", 
       RowBox[{"HermiteH", "[", 
        RowBox[{"1", ",", " ", "x"}], "]"}]}]}], " ", ",", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "  ", "t"}], "]"}], " ", "\[Equal]", " ", 
      "0"}], ",", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"5", ",", "t"}], "]"}], " ", "\[Equal]", " ", "0"}]}], "    ", 
    "\n", "\t\t", "}"}], ",", "\n", "\t\t", "\[Psi]", ",", " ", 
   "\[IndentingNewLine]", "\t\t", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}], ",", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "x", "}"}], " ", "\[Element]", " ", 
    RowBox[{"Interval", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5"}], ",", "5"}], "}"}], "]"}]}]}], "\n", "\t", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7081439356295614`*^9, 3.7081439730654917`*^9}, {
  3.7081440032320843`*^9, 
  3.7081440303970375`*^9}},ExpressionUUID->"61e427fd-30eb-42f2-a61b-\
bb15a2f472d5"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["InterpolatingFunction", "SummaryHead"], 
       "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, 
               ImageSize -> {Automatic, 
                 Dynamic[
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])]}, PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.`"}], ",", "5.`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "1.`"}], "}"}]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"scalar\"", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, 
               ImageSize -> {Automatic, 
                 Dynamic[
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])]}, PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5.`"}], ",", "5.`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "1.`"}], "}"}]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"scalar\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Order: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"Unstructured\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Periodic: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["False", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->(
    "InterpolatingFunction[{{-5., 5.}, {0., 1.}}, <>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.708143963748082*^9, 3.708143974034113*^9}, {
  3.7081440116790533`*^9, 
  3.708144032515373*^9}},ExpressionUUID->"7272947d-0fcf-4ac5-a67a-\
1a0b078bb7ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"thing", " ", "=", " \t", 
  RowBox[{"NDSolveValue", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"schrodEqu", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox["#", "2"]}], "&"}], ",", " ", "x", ",", " ", "y", 
        ",", " ", "t"}], "]"}], 
      StyleBox[",", "Code"], 
      StyleBox["\n", "Code"], 
      StyleBox["\t\t\t", "Code"], 
      RowBox[{
       StyleBox[
        RowBox[{"\[Psi]", "[", 
         RowBox[{"x", ",", " ", "y", ",", " ", "0"}], "]"}], "Code"], 
       StyleBox[" ", "Code"], 
       StyleBox["\[Equal]", "Code"], " ", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["2"]], 
        FractionBox["1", 
         SuperscriptBox["\[Pi]", 
          RowBox[{"1", "/", "4"}]]], 
        RowBox[{"Exp", "[", 
         FractionBox[
          RowBox[{"-", 
           SuperscriptBox["x", "2"]}], "2"], "]"}], " ", 
        RowBox[{"Exp", "[", 
         FractionBox[
          RowBox[{"-", 
           SuperscriptBox["y", "2"]}], "2"], "]"}], " ", 
        RowBox[{"HermiteH", "[", 
         RowBox[{"1", ",", " ", "x"}], "]"}], "  ", 
        RowBox[{"HermiteH", "[", 
         RowBox[{"1", ",", "y"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      "\t\t", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{
         RowBox[{"-", "5"}], ",", " ", "y", ",", "  ", "t"}], "]"}], " ", 
       "\[Equal]", " ", "0"}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"5", ",", " ", "y", ",", " ", "t"}], "]"}], " ", "\[Equal]", 
       " ", "0"}], ",", "    ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"apparently", " ", "x0"}], ",", " ", 
        RowBox[{"y0", " ", "can", " ", "be", " ", 
         RowBox[{"infinity", "!"}]}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"-", "5"}], ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
       "0"}], ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"x", ",", " ", "5", ",", " ", "t"}], "]"}], " ", "\[Equal]", 
       " ", "0"}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", "\[Psi]", ",", 
    " ", "\[IndentingNewLine]", "\t\t", 
    RowBox[{"{", 
     RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y"}], "}"}], " ", "\[Element]", " ", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]}]}], "\n", "\t", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.708140376230235*^9, 3.708140379392476*^9}, {
  3.708141436228916*^9, 3.7081414856425886`*^9}, {3.708141591001562*^9, 
  3.708141594970378*^9}, {3.7081417306411457`*^9, 3.7081417309217052`*^9}, {
  3.708141770743925*^9, 3.708141803200001*^9}, {3.708143237858884*^9, 
  3.708143238758627*^9}, {3.708143273623208*^9, 3.708143352446911*^9}, {
  3.7081433954244156`*^9, 3.708143407487739*^9}, {3.7081435282275257`*^9, 
  3.7081435402990355`*^9}, {3.70814363611108*^9, 3.708143643550125*^9}, {
  3.7081437167881937`*^9, 3.7081437268207674`*^9}, {3.7081437732396097`*^9, 
  3.708143782733699*^9}, {3.708144048467291*^9, 
  3.7081440666821823`*^9}},ExpressionUUID->"dd36f0b9-f528-4960-897f-\
66bc6141a925"],

Cell[BoxData[
 TemplateBox[{
  "NDSolveValue","bcedge",
   "\"Boundary condition \\!\\(\\*RowBox[{RowBox[{\\\"\[Psi]\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"t\\\"}], \\\"]\\\"}], \
\\\"\[Equal]\\\", \\\"0\\\"}]\\) is not specified on a single edge of the \
boundary of the computational domain.\"",2,98,27,32570342810223902751,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7081440674823647`*^9},ExpressionUUID->"3a603a61-2079-499b-b13f-\
22991fe16aeb"],

Cell[BoxData[
 RowBox[{"NDSolveValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{
        SuperscriptBox["\[Psi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "\[Equal]", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            SuperscriptBox["\[Psi]", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "2", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["\[Psi]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"x", ",", "y", ",", "0"}], "]"}], "\[Equal]", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox["x", "2"], "2"]}], "-", 
          FractionBox[
           SuperscriptBox["y", "2"], "2"]}]], " ", "x", " ", "y"}], 
       SuperscriptBox["\[Pi]", 
        RowBox[{"1", "/", "4"}]]]}], ",", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "y", ",", "t"}], "]"}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"5", ",", "y", ",", "t"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"x", ",", 
        RowBox[{"-", "5"}], ",", "t"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"x", ",", "5", ",", "t"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", "\[Psi]", ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.7081416919012485`*^9, 3.708141731888815*^9, 3.7081417844398904`*^9, 
   3.708141816642541*^9, 3.708143414476513*^9, {3.708143530113268*^9, 
   3.708143541161396*^9}, 3.708143727490385*^9, 3.708143793452933*^9, {
   3.708144049683401*^9, 
   3.708144067502998*^9}},ExpressionUUID->"e4bbf920-d282-465c-806f-\
a4a81e4fb96f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Animate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{"PlotWavefunction", "[", 
    RowBox[{
     RowBox[{"thing", "[", 
      RowBox[{"x", ",", " ", "y", ",", "  ", "t"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", 
       RowBox[{"-", "5"}], ",", " ", "5"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"y", ",", " ", 
       RowBox[{"-", "5"}], ",", " ", "5"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.708140385044821*^9, 3.7081404526259327`*^9}, {
  3.708141829191906*^9, 
  3.7081418347799025`*^9}},ExpressionUUID->"d3b9ee9f-d3ed-4093-ae77-\
988a2f8d8ec4"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 0.6262527465820312, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 1}}, Typeset`size$$ = {36., {0., 10.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$53128$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$53128$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> PlotFunctions`PlotWavefunction[
        $CellContext`thing[$CellContext`x, $CellContext`y, $CellContext`t$$], \
{$CellContext`x, -5, 5}, {$CellContext`y, -5, 5}], 
      "Specifications" :> {{$CellContext`t$$, 0, 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{395., {52., 59.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7081404531581864`*^9, 3.708141504433736*^9, 3.7081416058887835`*^9, {
   3.7081416709045286`*^9, 3.708141697192071*^9}, 3.708141735260793*^9, 
   3.708141835484346*^9},ExpressionUUID->"b2083211-c67e-4ee2-a773-\
4debb3240f70"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Abs", "[", " ", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SuperscriptBox["\[Pi]", 
        RowBox[{"1", "/", "4"}]]], 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{"-", 
         SuperscriptBox["x", "2"]}], "2"], "]"}], " ", 
      RowBox[{"HermiteH", "[", 
       RowBox[{"1", ",", " ", "x"}], "]"}]}], "]"}], "2"], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", 
     RowBox[{"-", "5"}], ",", " ", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.708140726315857*^9, 3.708140729746614*^9}, {
  3.708141620861887*^9, 
  3.7081416405544205`*^9}},ExpressionUUID->"eea9d9bf-f657-46be-b17b-\
0951a0a91b81"],

Cell[BoxData["0.99999999992011`"], "Output",
 CellChangeTimes->{{3.708141638203474*^9, 
  3.7081416417911043`*^9}},ExpressionUUID->"92a56e6c-fa6e-495c-92bc-\
e2a1f7d32a40"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{16, Automatic}, {Automatic, 82}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 252, 4, 201, "Title", "ExpressionUUID" -> \
"82d16c13-a4eb-4dff-88b1-256f342d7961"],
Cell[835, 28, 624, 14, 62, "Input", "ExpressionUUID" -> \
"8d204cd5-d7c9-431b-b385-1ca7530127c3"],
Cell[CellGroupData[{
Cell[1484, 46, 163, 3, 85, "Section", "ExpressionUUID" -> \
"84fa818c-6a8a-4d1c-be9c-f9313f98a286"],
Cell[1650, 51, 439, 10, 128, "Code", "ExpressionUUID" -> \
"7d33919b-3482-4426-ba8e-615f4ccc7d13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2126, 66, 163, 3, 85, "Section", "ExpressionUUID" -> \
"8aa0a0d4-6a0c-4926-8145-f356b8db5238"],
Cell[2292, 71, 274, 6, 35, "Text", "ExpressionUUID" -> \
"39c285aa-e9d8-4f9d-9eec-943d61ef708a"],
Cell[2569, 79, 13562, 294, 1701, "Code", "ExpressionUUID" -> \
"b8a9d512-be86-4be1-b81d-5867eff2bd7b"],
Cell[16134, 375, 3230, 76, 462, "Code", "ExpressionUUID" -> \
"969b1a4d-a0e9-4dbe-9e98-a5830560f3e7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19413, 457, 173, 3, 122, "Title", "ExpressionUUID" -> \
"b77b4dee-994d-4818-9539-89d8f9988110"],
Cell[19589, 462, 1610, 54, 62, "Input", "ExpressionUUID" -> \
"8c52806e-1500-43c6-aa21-1d199c8e51e4"],
Cell[CellGroupData[{
Cell[21224, 520, 421, 12, 55, "Input", "ExpressionUUID" -> \
"5eef8d93-58c3-450f-88b0-237c6372469d"],
Cell[21648, 534, 1314, 41, 53, "Output", "ExpressionUUID" -> \
"af4299bd-acb6-47b8-b163-773ef5db0721"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22999, 580, 1886, 55, 360, "Input", "ExpressionUUID" -> \
"61e427fd-30eb-42f2-a61b-bb15a2f472d5"],
Cell[24888, 637, 9415, 194, 81, "Output", "ExpressionUUID" -> \
"7272947d-0fcf-4ac5-a67a-1a0b078bb7ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34340, 836, 3556, 90, 408, "Input", "ExpressionUUID" -> \
"dd36f0b9-f528-4960-897f-66bc6141a925"],
Cell[37899, 928, 515, 10, 27, "Message", "ExpressionUUID" -> \
"3a603a61-2079-499b-b13f-22991fe16aeb"],
Cell[38417, 940, 3132, 92, 154, "Output", "ExpressionUUID" -> \
"e4bbf920-d282-465c-806f-a4a81e4fb96f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41586, 1037, 783, 20, 110, "Input", "ExpressionUUID" -> \
"d3b9ee9f-d3ed-4093-ae77-988a2f8d8ec4"],
Cell[42372, 1059, 2237, 44, 131, "Output", "ExpressionUUID" -> \
"b2083211-c67e-4ee2-a773-4debb3240f70"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44646, 1108, 772, 23, 63, "Input", "ExpressionUUID" -> \
"eea9d9bf-f657-46be-b17b-0951a0a91b81"],
Cell[45421, 1133, 172, 3, 37, "Output", "ExpressionUUID" -> \
"92a56e6c-fa6e-495c-92bc-e2a1f7d32a40"]
}, Open  ]]
}, Open  ]]
}
]
*)

